<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RBX Checker ‚Äî by @lanavienrose</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root {
  --bg:       #06060f;
  --bg2:      #0b0b18;
  --bg3:      #0f0f22;
  --panel:    #0d0d1e;
  --border:   #1a1a35;
  --border2:  #252545;
  --text:     #d4d4f0;
  --text2:    #8888b8;
  --text3:    #4a4a6a;
  --accent:   #00f5cc;
  --accent2:  #0099ff;
  --purple:   #7c63ff;
  --danger:   #ff3366;
  --warn:     #ff9500;
  --valid:    #00e676;
  --banned:   #ff3366;
  --ingame:   #00bfff;
  --mono:     'Space Mono', monospace;
  --code:     'Share Tech Mono', monospace;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: var(--code);
  min-height: 100vh;
  overflow-x: hidden;
}

/* Grid background */
body::before {
  content: '';
  position: fixed; inset: 0; z-index: 0;
  background-image:
    linear-gradient(rgba(0,245,204,.025) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,245,204,.025) 1px, transparent 1px);
  background-size: 40px 40px;
  pointer-events: none;
}

/* Glow orbs */
.orb {
  position: fixed; border-radius: 50%; filter: blur(80px); pointer-events: none; z-index: 0; opacity: .18;
}
.orb-1 { width: 500px; height: 500px; background: radial-gradient(circle, var(--purple), transparent); top: -100px; right: -100px; }
.orb-2 { width: 400px; height: 400px; background: radial-gradient(circle, var(--accent), transparent); bottom: -80px; left: -80px; }

/* Layout */
.app { position: relative; z-index: 1; display: grid; grid-template-rows: auto 1fr; min-height: 100vh; }

/* Header */
header {
  border-bottom: 1px solid var(--border);
  background: rgba(6,6,15,.9);
  backdrop-filter: blur(12px);
  padding: 14px 24px;
  display: flex; align-items: center; justify-content: space-between;
  position: sticky; top: 0; z-index: 100;
}
.logo {
  font-family: var(--mono); font-size: 15px; font-weight: 700;
  letter-spacing: 4px; color: var(--accent);
  display: flex; align-items: center; gap: 10px;
}
.logo::before { content: '‚óà'; font-size: 18px; }
.logo-sub { font-size: 9px; color: var(--text3); letter-spacing: 3px; font-weight: 400; }
.header-right { display: flex; gap: 8px; align-items: center; }
.header-btn {
  font-family: var(--mono); font-size: 9px; letter-spacing: 2px; padding: 5px 12px;
  border: 1px solid var(--border2); background: transparent; color: var(--text2);
  border-radius: 3px; cursor: pointer; transition: all .15s;
}
.header-btn:hover { border-color: var(--accent); color: var(--accent); }
.header-btn.active { border-color: var(--purple); color: var(--purple); }

/* Main grid */
main {
  display: grid;
  grid-template-columns: 380px 1fr;
  gap: 0;
  align-items: start;
  padding: 20px;
  gap: 16px;
}
@media (max-width: 800px) { main { grid-template-columns: 1fr; } }

/* Panels */
.panel {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 8px;
  overflow: hidden;
}
.panel-header {
  padding: 12px 16px;
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
  background: rgba(255,255,255,.02);
}
.panel-title {
  font-family: var(--mono); font-size: 10px; letter-spacing: 3px; color: var(--text2);
}
.panel-body { padding: 14px 16px; }

/* Input area */
.paste-area {
  width: 100%; min-height: 160px;
  background: var(--bg); border: 1px solid var(--border2);
  color: var(--text); font-family: var(--code); font-size: 11px; line-height: 1.6;
  padding: 10px 12px; border-radius: 6px; resize: vertical;
  transition: border-color .2s;
}
.paste-area:focus { outline: none; border-color: var(--accent); }
.paste-area::placeholder { color: var(--text3); }

.format-hint {
  font-size: 10px; color: var(--text3); margin-top: 8px; line-height: 1.7;
}
.format-hint code { color: var(--accent); background: rgba(0,245,204,.06); padding: 1px 5px; border-radius: 2px; }

/* Proxy row */
.proxy-row {
  display: flex; gap: 6px; align-items: center; margin-bottom: 10px;
}
.proxy-input {
  flex: 1; background: var(--bg); border: 1px solid var(--border2);
  color: var(--text); font-family: var(--code); font-size: 11px;
  padding: 7px 10px; border-radius: 5px;
}
.proxy-input:focus { outline: none; border-color: var(--purple); }

/* Buttons */
.btn {
  font-family: var(--mono); font-size: 10px; letter-spacing: 1.5px;
  padding: 8px 16px; border-radius: 5px; cursor: pointer;
  border: 1px solid transparent; transition: all .15s; white-space: nowrap;
}
.btn-accent  { background: var(--accent); color: #06060f; border-color: var(--accent); }
.btn-accent:hover  { background: #00ffd5; }
.btn-ghost   { background: transparent; color: var(--text2); border-color: var(--border2); }
.btn-ghost:hover   { border-color: var(--accent); color: var(--accent); }
.btn-danger  { background: transparent; color: var(--danger); border-color: var(--danger); }
.btn-danger:hover  { background: rgba(255,51,102,.1); }
.btn-purple  { background: var(--purple); color: #fff; border-color: var(--purple); }
.btn-purple:hover  { background: #9580ff; }
.btn-sm { padding: 5px 10px; font-size: 9px; }
.btn-full { width: 100%; justify-content: center; display: flex; align-items: center; gap: 6px; }

/* Control bar */
.control-bar {
  display: flex; gap: 8px; flex-wrap: wrap; margin-top: 12px; align-items: center;
}
.delay-select {
  background: var(--bg); border: 1px solid var(--border2); color: var(--text);
  font-family: var(--code); font-size: 10px; padding: 6px 8px; border-radius: 4px;
}

/* Progress */
.progress-wrap { margin: 12px 0 6px; }
.progress-track {
  height: 3px; background: var(--border); border-radius: 2px; overflow: hidden;
}
.progress-bar {
  height: 100%; width: 0%; background: linear-gradient(90deg, var(--purple), var(--accent));
  border-radius: 2px; transition: width .3s ease;
}
.progress-label {
  display: flex; justify-content: space-between; align-items: center;
  font-size: 10px; color: var(--text3); margin-bottom: 6px;
}

/* Summary chips */
.summary-bar {
  display: flex; gap: 6px; flex-wrap: wrap; margin: 8px 0;
}
.chip {
  font-family: var(--mono); font-size: 9px; letter-spacing: 1px;
  padding: 3px 10px; border-radius: 12px; border: 1px solid;
}
.chip-valid   { color: var(--valid);  border-color: rgba(0,230,118,.3);  background: rgba(0,230,118,.06); }
.chip-banned  { color: var(--banned); border-color: rgba(255,51,102,.3); background: rgba(255,51,102,.06); }
.chip-warn    { color: var(--warn);   border-color: rgba(255,149,0,.3);  background: rgba(255,149,0,.06); }
.chip-invalid { color: var(--text3);  border-color: var(--border2);       background: transparent; }
.chip-ingame  { color: var(--ingame); border-color: rgba(0,191,255,.3);  background: rgba(0,191,255,.06); }

/* Result cards */
.results-box {
  max-height: calc(100vh - 200px);
  overflow-y: auto;
  padding-right: 4px;
}
.results-box::-webkit-scrollbar { width: 4px; }
.results-box::-webkit-scrollbar-track { background: transparent; }
.results-box::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 2px; }

.result-card {
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: 6px; padding: 12px 14px; margin-bottom: 8px;
  border-left: 3px solid var(--border2);
  transition: border-color .2s;
  animation: cardIn .2s ease;
}
@keyframes cardIn { from { opacity:0; transform:translateY(-4px); } to { opacity:1; transform:translateY(0); } }
.result-card.valid   { border-left-color: var(--valid); }
.result-card.banned  { border-left-color: var(--banned); }
.result-card.warned  { border-left-color: var(--warn); }
.result-card.invalid { border-left-color: var(--text3); }
.result-card.checking { border-left-color: var(--purple); }

.card-top {
  display: flex; align-items: flex-start; justify-content: space-between; gap: 8px; flex-wrap: wrap;
}
.card-user {
  font-family: var(--code); font-size: 12px; color: var(--text); word-break: break-all;
}
.card-user .roblox-name {
  font-size: 10px; color: var(--accent); margin-top: 2px;
}
.status-badge {
  font-family: var(--mono); font-size: 9px; letter-spacing: 1.5px; padding: 3px 9px;
  border-radius: 10px; border: 1px solid; white-space: nowrap; flex-shrink: 0;
}
.sb-valid    { color: var(--valid);  border-color: rgba(0,230,118,.4);  background: rgba(0,230,118,.07); }
.sb-banned   { color: var(--banned); border-color: rgba(255,51,102,.4); background: rgba(255,51,102,.07); }
.sb-warned   { color: var(--warn);   border-color: rgba(255,149,0,.4);  background: rgba(255,149,0,.07); }
.sb-invalid  { color: var(--text3);  border-color: var(--border2);       background: transparent; }
.sb-checking { color: var(--purple); border-color: rgba(124,99,255,.4); background: rgba(124,99,255,.07); }
.sb-tempban  { color: #ff6600; border-color: rgba(255,102,0,.4); background: rgba(255,102,0,.07); }

.card-meta {
  display: flex; gap: 10px; flex-wrap: wrap; margin-top: 8px; font-size: 10px; color: var(--text3);
}
.card-meta-item { display: flex; align-items: center; gap: 4px; }
.meta-dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
.meta-dot.online  { background: var(--valid); box-shadow: 0 0 4px var(--valid); }
.meta-dot.ingame  { background: var(--ingame); box-shadow: 0 0 4px var(--ingame); }
.meta-dot.studio  { background: #ff8800; }
.meta-dot.offline { background: var(--text3); }

.card-note {
  margin-top: 8px; font-size: 10px; color: var(--warn);
  background: rgba(255,149,0,.06); border: 1px solid rgba(255,149,0,.15);
  border-radius: 4px; padding: 5px 9px; line-height: 1.5;
}

.empty-state {
  text-align: center; padding: 60px 20px; color: var(--text3);
}
.empty-icon { font-size: 36px; display: block; margin-bottom: 12px; opacity: .3; }
.empty-label { font-family: var(--mono); font-size: 10px; letter-spacing: 3px; }

/* Guide Modal */
.modal-overlay {
  display: none; position: fixed; inset: 0; z-index: 1000;
  background: rgba(0,0,0,.8); backdrop-filter: blur(6px);
  align-items: flex-start; justify-content: center;
  padding: 20px; overflow-y: auto;
}
.modal-overlay.open { display: flex; }
.modal {
  background: var(--panel); border: 1px solid var(--border2); border-radius: 10px;
  max-width: 680px; width: 100%; padding: 28px; position: relative;
  margin: auto;
}
.modal-close {
  position: absolute; top: 16px; right: 16px; background: none; border: none;
  color: var(--text3); font-size: 18px; cursor: pointer; line-height: 1;
}
.modal-close:hover { color: var(--text); }
.modal h2 { font-family: var(--mono); font-size: 14px; letter-spacing: 3px; color: var(--accent); margin-bottom: 20px; }
.modal h3 { font-family: var(--mono); font-size: 11px; letter-spacing: 2px; color: var(--purple); margin: 18px 0 8px; }
.modal p, .modal li { font-size: 12px; color: var(--text2); line-height: 1.8; }
.modal li { margin-left: 16px; margin-bottom: 4px; }
.modal code { font-family: var(--code); color: var(--accent); background: rgba(0,245,204,.07); padding: 1px 6px; border-radius: 3px; font-size: 11px; }
.modal .step { display: flex; gap: 12px; align-items: flex-start; margin-bottom: 14px; }
.modal .step-num { font-family: var(--mono); font-size: 11px; color: var(--purple); background: rgba(124,99,255,.1); border: 1px solid rgba(124,99,255,.3); border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; margin-top: 2px; }
.modal .step-body { flex: 1; }
.modal .step-title { font-family: var(--mono); font-size: 10px; color: var(--text); margin-bottom: 4px; letter-spacing: 1px; }

/* Worker code display */
.worker-code {
  background: var(--bg); border: 1px solid var(--border2); border-radius: 6px;
  padding: 14px; font-family: var(--code); font-size: 10px; color: #00e6aa;
  white-space: pre; overflow-x: auto; line-height: 1.7; margin: 10px 0;
  max-height: 240px; overflow-y: auto;
}

/* Status legend */
.legend { display: flex; flex-direction: column; gap: 6px; margin-top: 10px; }
.legend-row { display: flex; align-items: center; gap: 10px; font-size: 11px; color: var(--text2); }
.legend-badge { font-family: var(--mono); font-size: 9px; padding: 2px 8px; border-radius: 8px; border: 1px solid; min-width: 90px; text-align: center; }

/* Export bar */
.export-bar {
  display: flex; gap: 6px; flex-wrap: wrap; margin-top: 10px; padding-top: 10px;
  border-top: 1px solid var(--border);
}

/* Toast */
#toast {
  position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
  background: var(--bg3); border: 1px solid var(--border2); color: var(--text);
  font-family: var(--mono); font-size: 10px; letter-spacing: 1px;
  padding: 10px 20px; border-radius: 6px; z-index: 9999;
  opacity: 0; transition: opacity .2s; pointer-events: none;
  white-space: nowrap;
}
#toast.show { opacity: 1; }

/* Scrollbar global */
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }

/* Animations */
@keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:.5; } }
.checking-pulse { animation: pulse 1s infinite; }
</style>
</head>
<body>
<div class="orb orb-1"></div>
<div class="orb orb-2"></div>

<div class="app">

<!-- HEADER -->
<header>
  <div class="logo">
    RBX CHECKER
    <div class="logo-sub">by @lanavienrose</div>
  </div>
  <div class="header-right">
    <button class="header-btn" onclick="openGuide()">üìñ SETUP GUIDE</button>
    <button class="header-btn active" id="toggle-worker-btn" onclick="toggleWorkerPanel()">‚öô WORKER CODE</button>
  </div>
</header>

<!-- SETUP GUIDE MODAL -->
<div class="modal-overlay" id="guide-modal">
  <div class="modal">
    <button class="modal-close" onclick="closeGuide()">‚úï</button>
    <h2>SETUP GUIDE</h2>

    <h3>OVERVIEW</h3>
    <p>This tool checks Roblox cookies via a <b>Cloudflare Worker</b> you own. The worker acts as a proxy between this page and Roblox's API, bypassing browser CORS restrictions. Your cookies are sent directly to <i>your</i> worker ‚Äî not to any third party.</p>

    <h3>STEP 1 ‚Äî CREATE A CLOUDFLARE ACCOUNT</h3>
    <div class="step">
      <div class="step-num">1</div>
      <div class="step-body">
        <div class="step-title">Go to workers.cloudflare.com</div>
        <p>Sign up for a free account at <code>workers.cloudflare.com</code>. The free plan allows 100,000 requests/day which is more than enough.</p>
      </div>
    </div>

    <h3>STEP 2 ‚Äî CREATE THE WORKER</h3>
    <div class="step">
      <div class="step-num">1</div>
      <div class="step-body">
        <div class="step-title">Dashboard ‚Üí Workers & Pages ‚Üí Create Worker</div>
        <p>Click "Create Worker". You'll see a default "Hello World" script.</p>
      </div>
    </div>
    <div class="step">
      <div class="step-num">2</div>
      <div class="step-body">
        <div class="step-title">Replace the code completely</div>
        <p>Delete all the default code and paste the worker code shown in the ‚öô WORKER CODE panel. Click <b>Deploy</b>.</p>
      </div>
    </div>
    <div class="step">
      <div class="step-num">3</div>
      <div class="step-body">
        <div class="step-title">Copy your Worker URL</div>
        <p>After deploy, you'll see a URL like <code>your-worker.workers.dev</code>. Copy it.</p>
      </div>
    </div>

    <h3>STEP 3 ‚Äî CONFIGURE THIS TOOL</h3>
    <div class="step">
      <div class="step-num">1</div>
      <div class="step-body">
        <div class="step-title">Paste your Worker URL in the Proxy URL field</div>
        <p>Back in this page, paste your worker URL into the <b>PROXY URL</b> field and click TEST to verify it works.</p>
      </div>
    </div>
    <div class="step">
      <div class="step-num">2</div>
      <div class="step-body">
        <div class="step-title">Paste your cookies and run</div>
        <p>Paste your cookies in any of these formats (one per line):<br>
        ‚Ä¢ <code>username:_|WARNING:...</code><br>
        ‚Ä¢ <code>username:password:_|WARNING:...</code><br>
        ‚Ä¢ Just <code>_|WARNING:...</code> (no username)</p>
      </div>
    </div>

    <h3>HOST ON GITHUB PAGES (run online)</h3>
    <div class="step">
      <div class="step-num">1</div>
      <div class="step-body">
        <div class="step-title">Create a GitHub repository</div>
        <p>Go to <code>github.com</code> ‚Üí New repository ‚Üí name it anything (e.g. <code>rbx-checker</code>).</p>
      </div>
    </div>
    <div class="step">
      <div class="step-num">2</div>
      <div class="step-body">
        <div class="step-title">Upload this file as index.html</div>
        <p>Rename this file to <code>index.html</code>, then drag it into the repo on GitHub. Commit.</p>
      </div>
    </div>
    <div class="step">
      <div class="step-num">3</div>
      <div class="step-body">
        <div class="step-title">Enable GitHub Pages</div>
        <p>Repo ‚Üí <b>Settings</b> ‚Üí <b>Pages</b> ‚Üí Source: <b>Deploy from branch</b> ‚Üí Branch: <b>main</b> ‚Üí Folder: <b>/ (root)</b> ‚Üí Save.</p>
      </div>
    </div>
    <div class="step">
      <div class="step-num">4</div>
      <div class="step-body">
        <div class="step-title">Your site is live</div>
        <p>Within 1-2 minutes: <code>https://yourusername.github.io/rbx-checker</code> is live. Access from any device.</p>
      </div>
    </div>

    <h3>STATUS MEANINGS</h3>
    <div class="legend">
      <div class="legend-row"><span class="legend-badge chip-valid">‚úÖ VALID</span> Cookie works, account is in good standing</div>
      <div class="legend-row"><span class="legend-badge chip-valid" style="color:var(--ingame)">üéÆ IN GAME</span> Valid + currently playing a Roblox game</div>
      <div class="legend-row"><span class="legend-badge chip-valid" style="color:#00e676;border-color:rgba(0,230,118,.3)">üü¢ ONLINE</span> Valid + active on Roblox website</div>
      <div class="legend-row"><span class="legend-badge" style="color:#888;border-color:#333">üî¥ OFFLINE</span> Valid but not currently active</div>
      <div class="legend-row"><span class="legend-badge chip-warn">‚ö† WARNED</span> Valid but account has an active warning</div>
      <div class="legend-row"><span class="legend-badge chip-banned">üî® PERM BAN</span> Account is permanently banned</div>
      <div class="legend-row"><span class="legend-badge" style="color:#ff6600;border-color:rgba(255,102,0,.3);background:rgba(255,102,0,.06)">‚è≥ TEMP BAN</span> Cookie invalid ‚Äî likely temp banned (1d/7d ban invalidates session)</div>
      <div class="legend-row"><span class="legend-badge chip-invalid">‚ùå INVALID</span> Cookie expired or wrong</div>
    </div>

    <h3>WHY IS TEMP BAN SHOWN AS "INVALID"?</h3>
    <p>When Roblox issues a temporary ban (1 day, 7 day), it immediately invalidates all existing sessions ‚Äî so the cookie stops working during the ban period. Once the ban ends, the cookie may become valid again. There is no official public API to distinguish between "expired cookie" and "active temp ban" ‚Äî but if an account was recently valid and suddenly shows invalid, it's very likely a temp ban.</p>
  </div>
</div>

<!-- WORKER CODE MODAL -->
<div id="worker-panel" style="display:none; background:var(--bg2); border-bottom:1px solid var(--border); padding:16px 24px;">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
    <div style="font-family:var(--mono);font-size:10px;letter-spacing:2px;color:var(--purple)">‚öô CLOUDFLARE WORKER CODE</div>
    <button class="btn btn-ghost btn-sm" onclick="copyWorkerCode()">üìã COPY CODE</button>
  </div>
  <div class="worker-code" id="worker-code-display"></div>
  <div style="font-size:10px;color:var(--text3);margin-top:6px;line-height:1.6">
    Deploy this at <a href="https://workers.cloudflare.com" target="_blank" style="color:var(--purple)">workers.cloudflare.com</a> ‚Äî free tier, no credit card needed. Checks: auth status, ban/warn detection, online presence.
  </div>
</div>

<!-- MAIN -->
<main>

  <!-- LEFT: Input panel -->
  <div>
    <div class="panel">
      <div class="panel-header">
        <span class="panel-title">PROXY CONFIG</span>
        <span id="proxy-status-dot" style="font-size:9px;color:var(--text3)">NOT TESTED</span>
      </div>
      <div class="panel-body">
        <div class="proxy-row">
          <input class="proxy-input" type="text" id="proxy-url" placeholder="https://your-worker.workers.dev" autocomplete="off">
          <button class="btn btn-ghost btn-sm" onclick="testProxy()">TEST</button>
          <button class="btn btn-ghost btn-sm" onclick="saveProxy()">SAVE</button>
        </div>
      </div>
    </div>

    <div class="panel" style="margin-top:12px;">
      <div class="panel-header">
        <span class="panel-title">PASTE COOKIES</span>
        <span id="cookie-count" style="font-size:9px;color:var(--text3)">0 lines</span>
      </div>
      <div class="panel-body">
        <textarea class="paste-area" id="cookie-input" placeholder="Paste cookies here, one per line..." oninput="updateCount()" spellcheck="false"></textarea>
        <div class="format-hint">
          Supported: <code>user:_|WARNING:...</code> ¬∑ <code>user:pass:_|WARNING:...</code> ¬∑ <code>_|WARNING:...</code>
        </div>
        <div class="control-bar">
          <button class="btn btn-accent" onclick="startCheck()">‚ñ∂ RUN CHECK</button>
          <button class="btn btn-danger btn-sm" onclick="stopCheck()">‚ñ† STOP</button>
          <select class="delay-select" id="delay-select">
            <option value="500">0.5s</option>
            <option value="1000" selected>1s</option>
            <option value="2000">2s</option>
            <option value="3000">3s</option>
          </select>
          <button class="btn btn-ghost btn-sm" onclick="clearAll()">CLEAR</button>
        </div>
      </div>
    </div>

    <div class="panel" style="margin-top:12px;">
      <div class="panel-header"><span class="panel-title">FILTER</span></div>
      <div class="panel-body" style="display:flex;gap:6px;flex-wrap:wrap;">
        <button class="btn btn-ghost btn-sm" onclick="filterResults('all')" id="filter-all" style="border-color:var(--accent);color:var(--accent)">ALL</button>
        <button class="btn btn-ghost btn-sm" onclick="filterResults('valid')" id="filter-valid">‚úÖ VALID</button>
        <button class="btn btn-ghost btn-sm" onclick="filterResults('warned')" id="filter-warned">‚ö† WARNED</button>
        <button class="btn btn-ghost btn-sm" onclick="filterResults('banned')" id="filter-banned">üî® BANNED</button>
        <button class="btn btn-ghost btn-sm" onclick="filterResults('invalid')" id="filter-invalid">‚ùå INVALID</button>
      </div>
    </div>

    <div class="panel" style="margin-top:12px;">
      <div class="panel-header"><span class="panel-title">EXPORT</span></div>
      <div class="panel-body">
        <div class="export-bar" style="margin-top:0;padding-top:0;border:none;">
          <button class="btn btn-ghost btn-sm" onclick="exportResults('valid','cookie')">‚úÖ Valid Cookies</button>
          <button class="btn btn-ghost btn-sm" onclick="exportResults('valid','user:pass:cookie')">‚úÖ Valid Full</button>
          <button class="btn btn-ghost btn-sm" onclick="exportResults('banned','user')">üî® Banned Users</button>
          <button class="btn btn-ghost btn-sm" onclick="exportResults('all','json')">üìã Full JSON</button>
        </div>
      </div>
    </div>
  </div>

  <!-- RIGHT: Results panel -->
  <div>
    <div class="panel">
      <div class="panel-header">
        <span class="panel-title">RESULTS</span>
        <div style="display:flex;gap:8px;align-items:center;">
          <span id="checked-count" style="font-size:9px;color:var(--text3)">0 / 0</span>
        </div>
      </div>
      <div class="panel-body">
        <div class="progress-wrap" id="progress-wrap" style="display:none">
          <div class="progress-label">
            <span id="progress-label">Checking...</span>
            <span id="progress-pct">0%</span>
          </div>
          <div class="progress-track"><div class="progress-bar" id="progress-bar"></div></div>
        </div>
        <div class="summary-bar" id="summary-bar"></div>
        <div class="results-box" id="results-box">
          <div class="empty-state">
            <span class="empty-icon">üç™</span>
            <div class="empty-label">PASTE COOKIES AND RUN CHECK</div>
          </div>
        </div>
      </div>
    </div>
  </div>

</main>
</div>

<div id="toast"></div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   WORKER CODE STRING
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const WORKER_CODE = `export default {
  async fetch(request) {
    // Handle CORS preflight
    if (request.method === 'OPTIONS') {
      return new Response(null, {
        headers: {
          'Access-Control-Allow-Origin': '*',
          'Access-Control-Allow-Headers': 'X-Cookie',
          'Access-Control-Allow-Methods': 'GET, POST, OPTIONS'
        }
      });
    }

    const cookie = request.headers.get('X-Cookie') || '';
    const CORS = { 'Access-Control-Allow-Origin': '*', 'Content-Type': 'application/json' };
    const rbxCookie = '.ROBLOSECURITY=' + cookie;

    try {
      // ‚îÄ‚îÄ‚îÄ 1. Auth check ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      const authRes = await fetch(
        'https://users.roblox.com/v1/users/authenticated',
        { headers: { 'Cookie': rbxCookie } }
      );
      const auth = await authRes.json();

      // Invalid cookie
      if (auth.errors) {
        return new Response(
          JSON.stringify({ status: 'invalid', errors: auth.errors }),
          { headers: CORS }
        );
      }

      const userId = auth.id;
      const result = {
        status: 'valid',
        userId,
        username: auth.name,
        displayName: auth.displayName,
        isBanned: auth.isBanned || false,
        presence: null,
        warned: false,
        restrictions: null
      };

      // Permanent ban
      if (auth.isBanned) {
        result.status = 'banned';
        return new Response(JSON.stringify(result), { headers: CORS });
      }

      // ‚îÄ‚îÄ‚îÄ 2. Presence (online status) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      try {
        const presRes = await fetch(
          'https://presence.roblox.com/v1/presence/users',
          {
            method: 'POST',
            headers: { 'Cookie': rbxCookie, 'Content-Type': 'application/json' },
            body: JSON.stringify({ userIds: [userId] })
          }
        );
        const presData = await presRes.json();
        if (presData.userPresences && presData.userPresences[0]) {
          const p = presData.userPresences[0];
          // userPresenceType: 0=Offline 1=Online 2=InGame 3=InStudio
          const types = ['offline', 'online', 'ingame', 'studio'];
          result.presence = {
            type: types[p.userPresenceType] || 'offline',
            game: p.lastLocation || null,
            lastOnline: p.lastOnline || null
          };
        }
      } catch(e) {}

      // ‚îÄ‚îÄ‚îÄ 3. Account restrictions (warn detection) ‚îÄ
      try {
        const restRes = await fetch(
          'https://accountinformation.roblox.com/v1/account/security',
          { headers: { 'Cookie': rbxCookie } }
        );
        if (restRes.ok) {
          const restData = await restRes.json();
          // Check for any active account restrictions or warnings
          result.restrictions = restData;
        }
      } catch(e) {}

      // ‚îÄ‚îÄ‚îÄ 4. Check moderation / warnings ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      try {
        const modRes = await fetch(
          'https://apis.roblox.com/account-restrictions/v1/restrictions',
          { headers: { 'Cookie': rbxCookie } }
        );
        if (modRes.ok) {
          const modData = await modRes.json();
          if (modData.gameContextRestrictionType &&
              modData.gameContextRestrictionType !== 'NoRestriction') {
            result.warned = true;
            result.restrictionType = modData.gameContextRestrictionType;
            result.status = 'warned';
          }
        }
      } catch(e) {}

      return new Response(JSON.stringify(result), { headers: CORS });

    } catch(e) {
      return new Response(
        JSON.stringify({ status: 'error', message: e.message }),
        { headers: CORS }
      );
    }
  }
}`;

document.getElementById('worker-code-display').textContent = WORKER_CODE;

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STATE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let results    = [];    // { input, user, pass, cookie, status, data }
let abortCheck = false;
let activeFilter = 'all';

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   PARSER ‚Äî same logic as Saturnity Library
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function parseLine(line) {
  line = line.trim();
  if (!line) return null;
  const MARKER = '_|WARNING:';
  const idx = line.indexOf(MARKER);
  if (idx >= 0) {
    const cookie = line.substring(idx);
    const prefix = line.substring(0, idx).replace(/:$/, '');
    const parts = prefix.split(':');
    return { user: parts[0]||'', pass: parts.slice(1).join(':')||'', cookie };
  }
  // Fallback: split by colon
  const parts = line.split(':');
  return { user: parts[0]||'', pass: parts[1]||'', cookie: parts.slice(2).join(':') };
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   PROXY
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function saveProxy() {
  const url = document.getElementById('proxy-url').value.trim();
  localStorage.setItem('rbx_checker_proxy', url);
  toast('‚úì Proxy URL saved');
}

async function testProxy() {
  const url = document.getElementById('proxy-url').value.trim();
  const dot = document.getElementById('proxy-status-dot');
  if (!url) { toast('Enter a proxy URL first'); return; }
  dot.textContent = 'TESTING‚Ä¶'; dot.style.color = 'var(--purple)';
  try {
    const r = await fetch(url, { headers: { 'X-Cookie': 'test' } });
    const d = await r.json();
    if (d && typeof d === 'object') {
      dot.textContent = '‚úì ONLINE'; dot.style.color = 'var(--valid)';
      toast('‚úì Proxy is working!');
    } else {
      dot.textContent = '‚úó BAD RESPONSE'; dot.style.color = 'var(--danger)';
    }
  } catch(e) {
    dot.textContent = '‚úó UNREACHABLE'; dot.style.color = 'var(--danger)';
    toast('‚úó ' + e.message);
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CHECK ENGINE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
async function startCheck() {
  const proxyUrl = document.getElementById('proxy-url').value.trim();
  if (!proxyUrl) { toast('Set proxy URL first ‚Äî see Setup Guide'); return; }

  const raw = document.getElementById('cookie-input').value;
  const lines = raw.split('\n').map(l => l.trim()).filter(Boolean);
  if (!lines.length) { toast('No cookies to check'); return; }

  abortCheck = false;
  results = lines.map(l => ({ ...parseLine(l), input: l, status: 'pending', data: null })).filter(Boolean);

  document.getElementById('progress-wrap').style.display = 'block';
  const delay = parseInt(document.getElementById('delay-select').value) || 1000;
  let done = 0;

  renderAll();

  for (let i = 0; i < results.length; i++) {
    if (abortCheck) break;
    const r = results[i];
    r.status = 'checking';
    renderCard(i);

    try {
      const res = await fetch(proxyUrl, { headers: { 'X-Cookie': r.cookie } });
      const d   = await res.json();
      r.data = d;
      r.status = d.status || 'invalid';
    } catch(e) {
      r.status = 'error';
    }

    done++;
    renderCard(i);
    updateProgress(done, results.length);
    updateSummary();
    updateCheckedCount(done, results.length);
    await sleep(delay);
  }

  document.getElementById('progress-wrap').style.display = 'none';
  toast('Done: ' + countStatus('valid') + ' valid ¬∑ ' + countStatus('banned') + ' banned ¬∑ ' + countStatus('invalid') + ' invalid');
}

function stopCheck() { abortCheck = true; toast('Stopped'); }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RENDER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderAll() {
  const box = document.getElementById('results-box');
  box.innerHTML = '';
  results.forEach((r, i) => box.appendChild(makeCard(r, i)));
}

function renderCard(i) {
  const existing = document.getElementById('card-' + i);
  const newCard  = makeCard(results[i], i);
  if (existing) existing.replaceWith(newCard);
  else document.getElementById('results-box').appendChild(newCard);
}

function makeCard(r, i) {
  // Status display
  const statusMap = {
    pending:  { text: '‚è∏ PENDING',   cls: 'sb-checking', cardCls: 'checking', pulse: false },
    checking: { text: '‚è≥ CHECKING', cls: 'sb-checking', cardCls: 'checking', pulse: true  },
    valid:    { text: '‚úÖ VALID',     cls: 'sb-valid',    cardCls: 'valid',    pulse: false },
    warned:   { text: '‚ö† WARNED',    cls: 'sb-warned',   cardCls: 'warned',   pulse: false },
    banned:   { text: 'üî® PERM BAN', cls: 'sb-banned',   cardCls: 'banned',   pulse: false },
    invalid:  { text: '‚ùå INVALID',  cls: 'sb-invalid',  cardCls: 'invalid',  pulse: false },
    error:    { text: '‚ö† ERROR',     cls: 'sb-invalid',  cardCls: 'invalid',  pulse: false },
  };
  const s = statusMap[r.status] || statusMap.invalid;

  const card = document.createElement('div');
  card.className = 'result-card ' + s.cardCls;
  card.id = 'card-' + i;

  // Skip filtered cards
  if (activeFilter !== 'all' && r.status !== 'pending' && r.status !== 'checking' && r.status !== activeFilter) {
    card.style.display = 'none';
  }

  // Presence dot
  let presenceHtml = '';
  let presenceMeta = '';
  if (r.data && r.data.presence) {
    const p = r.data.presence;
    const pMap = {
      online:  { dot: 'online',  label: 'üü¢ Online',      extra: '' },
      ingame:  { dot: 'ingame',  label: 'üéÆ In Game',     extra: p.game ? ' ‚Äî ' + p.game : '' },
      studio:  { dot: 'studio',  label: 'üé® In Studio',   extra: '' },
      offline: { dot: 'offline', label: 'üî¥ Offline',     extra: '' },
    };
    const pm = pMap[p.type] || pMap.offline;
    presenceHtml = `<div class="card-meta-item"><div class="meta-dot ${pm.dot}"></div>${pm.label + pm.extra}</div>`;
  }

  // Account meta
  let metaHtml = '';
  if (r.data && r.data.userId) {
    metaHtml += `<div class="card-meta-item">ID: ${r.data.userId}</div>`;
  }

  // Note for possibly temp-banned
  let noteHtml = '';
  if (r.status === 'invalid' || r.status === 'error') {
    noteHtml = `<div class="card-note">‚ö† Cookie invalid ‚Äî may be expired, or account could be temporarily banned (1d/7d bans invalidate the session).</div>`;
  }
  if (r.status === 'warned') {
    noteHtml = `<div class="card-note">‚ö† Account has an active warning or restriction on it.</div>`;
  }

  // Roblox username from API
  const apiName = r.data && r.data.username ? `<div class="roblox-name">‚Üí ${r.data.username}${r.data.displayName && r.data.displayName !== r.data.username ? ' ('+r.data.displayName+')' : ''}</div>` : '';

  card.innerHTML = `
    <div class="card-top">
      <div class="card-user">
        ${esc(r.user || '(no username)')}
        ${apiName}
      </div>
      <span class="status-badge ${s.cls} ${s.pulse ? 'checking-pulse' : ''}">${s.text}</span>
    </div>
    ${(presenceHtml || metaHtml) ? `<div class="card-meta">${presenceHtml}${metaHtml}</div>` : ''}
    ${noteHtml}
  `;
  return card;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   FILTER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function filterResults(filter) {
  activeFilter = filter;
  ['all','valid','warned','banned','invalid'].forEach(f => {
    const btn = document.getElementById('filter-' + f);
    btn.style.borderColor = f === filter ? 'var(--accent)' : '';
    btn.style.color = f === filter ? 'var(--accent)' : '';
  });
  if (!results.length) return;
  results.forEach((r, i) => {
    const card = document.getElementById('card-' + i);
    if (!card) return;
    if (filter === 'all' || r.status === filter || r.status === 'checking' || r.status === 'pending') {
      card.style.display = '';
    } else {
      card.style.display = 'none';
    }
  });
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SUMMARY
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function updateSummary() {
  const total   = results.length;
  const valid   = countStatus('valid');
  const banned  = countStatus('banned');
  const warned  = countStatus('warned');
  const invalid = countStatus('invalid') + countStatus('error');
  const bar = document.getElementById('summary-bar');
  bar.innerHTML = [
    valid   ? `<span class="chip chip-valid">‚úÖ ${valid} VALID</span>`   : '',
    warned  ? `<span class="chip chip-warn">‚ö† ${warned} WARNED</span>`  : '',
    banned  ? `<span class="chip chip-banned">üî® ${banned} BANNED</span>` : '',
    invalid ? `<span class="chip chip-invalid">‚ùå ${invalid} INVALID</span>` : '',
    `<span class="chip" style="color:var(--text3);border-color:var(--border2)">TOTAL ${total}</span>`,
  ].join('');
}

function countStatus(s) { return results.filter(r => r.status === s).length; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   EXPORT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function exportResults(statusFilter, format) {
  const filtered = statusFilter === 'all' ? results : results.filter(r => r.status === statusFilter);
  if (!filtered.length) { toast('No results to export for that filter'); return; }

  let text = '';
  if (format === 'json') {
    text = JSON.stringify(filtered, null, 2);
  } else if (format === 'cookie') {
    text = filtered.map(r => r.cookie).join('\n');
  } else if (format === 'user') {
    text = filtered.map(r => r.data?.username || r.user).join('\n');
  } else if (format === 'user:pass:cookie') {
    text = filtered.map(r => [r.user, r.pass, r.cookie].filter(Boolean).join(':')).join('\n');
  }

  const blob = new Blob([text], { type: 'text/plain' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = `rbx-${statusFilter}-${Date.now()}.txt`;
  a.click();
  toast('Exported ' + filtered.length + ' entries');
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   UI HELPERS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function updateCount() {
  const lines = document.getElementById('cookie-input').value.split('\n').filter(l => l.trim()).length;
  document.getElementById('cookie-count').textContent = lines + ' line' + (lines !== 1 ? 's' : '');
}
function updateProgress(done, total) {
  const pct = Math.round(done / total * 100);
  document.getElementById('progress-bar').style.width = pct + '%';
  document.getElementById('progress-pct').textContent = pct + '%';
  document.getElementById('progress-label').textContent = `Checking ${done} of ${total}‚Ä¶`;
}
function updateCheckedCount(done, total) {
  document.getElementById('checked-count').textContent = done + ' / ' + total;
}
function clearAll() {
  results = [];
  document.getElementById('cookie-input').value = '';
  document.getElementById('cookie-count').textContent = '0 lines';
  document.getElementById('results-box').innerHTML = '<div class="empty-state"><span class="empty-icon">üç™</span><div class="empty-label">PASTE COOKIES AND RUN CHECK</div></div>';
  document.getElementById('summary-bar').innerHTML = '';
  document.getElementById('checked-count').textContent = '0 / 0';
  document.getElementById('progress-wrap').style.display = 'none';
}
function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
function esc(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

function toast(msg, duration = 2200) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.classList.add('show');
  clearTimeout(toast._t);
  toast._t = setTimeout(() => el.classList.remove('show'), duration);
}

function openGuide()  { document.getElementById('guide-modal').classList.add('open'); }
function closeGuide() { document.getElementById('guide-modal').classList.remove('open'); }

function toggleWorkerPanel() {
  const p = document.getElementById('worker-panel');
  const btn = document.getElementById('toggle-worker-btn');
  const open = p.style.display !== 'none';
  p.style.display = open ? 'none' : 'block';
  btn.classList.toggle('active', !open);
}

function copyWorkerCode() {
  navigator.clipboard.writeText(WORKER_CODE).then(() => toast('‚úì Worker code copied!'));
}

/* Close guide on background click */
document.getElementById('guide-modal').addEventListener('click', function(e) {
  if (e.target === this) closeGuide();
});

/* Init */
window.addEventListener('load', () => {
  const saved = localStorage.getItem('rbx_checker_proxy');
  if (saved) {
    document.getElementById('proxy-url').value = saved;
    document.getElementById('proxy-status-dot').textContent = 'SAVED';
    document.getElementById('proxy-status-dot').style.color = 'var(--text2)';
  }
});
</script>
</body>
</html>
